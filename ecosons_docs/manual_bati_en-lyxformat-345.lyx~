#LyX 1.6.10 created this file. For more info see http://www.lyx.org/
\lyxformat 345
\begin_document
\begin_header
\textclass article
\use_default_options true
\language english
\inputencoding auto
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\float_placement !t
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_amsmath 1
\use_esint 1
\cite_engine basic
\use_bibtopic false
\paperorientation portrait
\secnumdepth 3
\tocdepth 3
\paragraph_separation skip
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\author "" 
\author "" 
\end_header

\begin_body

\begin_layout Title
Bathymetry software manual
\end_layout

\begin_layout Standard
Ecosons is a program for processing acoustic data.
 The bathymetric calculation is one of the options this software allows.
 The following manual explains the operation of the bathymetric version
 of ecosons.
 
\end_layout

\begin_layout Standard
Once the ecosons_bathy.zip file is extracted into the destination folder
 (selected by the user), the octave program is run in this folder.
 The program is called through the “ec” command, opening a menu with 7 options:
 
\end_layout

\begin_layout Itemize
[1] Load transects/survey
\end_layout

\begin_layout Itemize
[2] Select working transect 
\end_layout

\begin_layout Itemize
[3] Bathymetry toolkit 
\end_layout

\begin_layout Itemize
[4] Plot
\end_layout

\begin_layout Itemize
[5] Export
\end_layout

\begin_layout Itemize
[6] Other
\end_layout

\begin_layout Itemize
[7] Quit 
\end_layout

\begin_layout Standard
The first two options are common to all the ecosons applications, while
 the third one is specific to the bathymetric application.
 In order to perform a bathymetry, we must follow steps 1 to 3 consecutively.
 However, for large studies the first two can be substituted by [3] Bathymetry
 toolkit / [2] One-step bathymetry computation, explained below.
\end_layout

\begin_layout Subsubsection*
[1] Load transects/survey
\end_layout

\begin_layout Standard
This option allows the loading of .raw files from the echosounder and, optionally
, their conversion to binary files .mat (Octave format), which allows for
 a faster loading of the data if those files exist.
 When selected, the list of echosounder models that can be read by the program
 will display (currently it only allows reading data acquired with Simrad
 single beam echosounders.) 
\end_layout

\begin_layout Itemize
Load data source format: 
\end_layout

\begin_layout Itemize
[1] Simrad single-beam 
\end_layout

\begin_layout Itemize
[2] Quit 
\end_layout

\begin_layout Standard
When selecting this type of echosounder (option [1]), if it is a dual frequency
 one, the software will ask which channel you wish to work with.
 Once the channel is selected, the program can retrieve previously read
 files (transformed from the echosounder’s .raw format to .mat)
\end_layout

\begin_layout Itemize
Select echosounder channel: 
\end_layout

\begin_layout Itemize
[1] Chan 1 (38 kHz) 
\end_layout

\begin_layout Itemize
[2] Chan 2 (200 kHz)
\end_layout

\begin_layout Itemize
Select an option: 1 
\end_layout

\begin_layout Itemize
Use preloaded MAT files if available? (Y/n) 
\end_layout

\begin_layout Standard
If we have not previously generated a working file, .mat, or we do not want
 to generate it, we’ll click no (“n”).
 Then we will be asked to select the route for the files we want to read.
 It is advisable that the files be stored under a subfolder inside the working
 folder (called, in this case, 
\begin_inset Quotes eld
\end_inset

data
\begin_inset Quotes erd
\end_inset

).
 The working folder will be by default that in which the ec.m program is
 located.
 
\end_layout

\begin_layout Standard
The software allows to select all the .raw files from a “data” folder (data/*.raw)
, files from different folders, i.e.
 files from a given day (data1/*D20060821*.raw, data2/*D20060821*.raw).
 
\end_layout

\begin_layout Itemize
Input file(s) pattern: data/*.raw 
\end_layout

\begin_layout Standard
Once the .raw files have been read and .mat files have been generated, we
 can start to perform the calculations for the generation of the bathymetry.
\end_layout

\begin_layout Subsubsection*
[2] Select working transect 
\end_layout

\begin_layout Standard
First we have to select those files we want to analyze among all those we
 have loaded.
 Selecting option [2] (Select working transect), the software offers two
 posible ways to make a selection:
\end_layout

\begin_layout Itemize
Choose selection method:
\end_layout

\begin_layout Itemize
[1] From transect list
\end_layout

\begin_layout Itemize
[2] Nearest transect to a point
\end_layout

\begin_layout Itemize
[3] Quit
\end_layout

\begin_layout Standard
The first option ([1] From transect list) shows the names of all the loaded
 files.
 
\end_layout

\begin_layout Itemize
[1] L0001-D20060821-T065551-EA400 
\end_layout

\begin_layout Itemize
[2] L0002-D20060821-T075632-EA400 
\end_layout

\begin_layout Itemize
[3] L0003-D20060821-T085057-EA400 
\end_layout

\begin_layout Itemize
[4] L0004-D20060821-T093835-EA400 
\end_layout

\begin_layout Itemize
[5] L0005-D20060821-T102441-EA400 
\end_layout

\begin_layout Itemize
[6] L0006-D20060821-T102620-EA400 
\end_layout

\begin_layout Itemize
[7] L0007-D20060821-T110338-EA400 
\end_layout

\begin_layout Itemize
[8] L0008-D20060821-T114410-EA400 
\end_layout

\begin_layout Standard
The user must select files through their numbers, correlative (1:4), not
 consecutively (1, 3) or both (1:4, 6).
\end_layout

\begin_layout Itemize
Select named transect number: 1:8 
\end_layout

\begin_layout Standard
Second option ([2] Nearest transect to a point) asks for the GPS coordinates
 of a given location, that should be written in square brackets and separated
 by a coma.
\end_layout

\begin_layout Itemize
Input latitude and longitude coordinates (as [lat,lon]): [43.6630,-8.08011]
 
\end_layout

\begin_layout Standard
Later on, the program asks for the number of transects closer to the location
 that is to be selected.
\end_layout

\begin_layout Itemize
Input number of transects to select (default, 1): 10 
\end_layout

\begin_layout Standard
When the program analyzes the selction, it informs of the number of loaded
 transects that have been finally selected.
\end_layout

\begin_layout Subsubsection*
[3] Bathymetry toolkit 
\end_layout

\begin_layout Standard
This option opens the specific application for bathymetry.
 Each of the options/phases of this application are explained below: 
\end_layout

\begin_layout Itemize
Bathymetry: 
\end_layout

\begin_layout Itemize
[1] Bottom detection 
\end_layout

\begin_layout Itemize
[2] One-step bathymetry computation 
\end_layout

\begin_layout Itemize
[3] Tide correction 
\end_layout

\begin_layout Itemize
[4] Bathymetry subsampling 
\end_layout

\begin_layout Itemize
[5] Bathymetry resampling 
\end_layout

\begin_layout Itemize
[6] Restore sonar bathymetry 
\end_layout

\begin_layout Itemize
[7] Quit 
\end_layout

\begin_layout Subsubsection*
[3] Bathymetry toolkit / [1] Bottom detection
\end_layout

\begin_layout Standard
The software allows for bottom detection following two different methods:
\end_layout

\begin_layout Itemize
Bottom algorithms: 
\end_layout

\begin_layout Itemize
[1] Averaged bounce 
\end_layout

\begin_layout Itemize
[2] Max+threshold 
\end_layout

\begin_layout Itemize
[3] Quit 
\end_layout

\begin_layout Standard
The first method (Averaged bounce) performs bottom determination for each
 ping, starting from the end of the near field and calculating the depths,
 weighed by power (in a linear scale).
 Thus, an estimation is obtained for the depth from which most of the reflected
 intensity is received.
 The user must define the size of the near field, which will work as the
 minimum distance from which the algorithm will search the bottom (minimum
 depth).
 
\end_layout

\begin_layout Itemize
Near field approx.
 (default 1.0 m): 
\end_layout

\begin_layout Standard
Moreover, this method allows smoothing out the detected bottom through the
 location of outlier values and their smoothing by averaging neighbor bottom
 values.
 The user must define the search window size (number of pings on the right
 and left of each ping) and the allowed tolerance (in standard deviation
 units); the higher the tolerance, a higher number of original bottom values
 will be kept.
\end_layout

\begin_layout Itemize
Range smoothing radius (no.
 pings; default no smoothing): 15 
\end_layout

\begin_layout Itemize
Smoothing sigmas (default, 3): 3 
\end_layout

\begin_layout Standard

\color black
The second method (Max+Threshold) is based on the search of the value which
 is 
\begin_inset Formula $X$
\end_inset

 dB below the ping maximum.
 In order to do this, the software searches for the bin with the maximum
 received power and calculates the bottom as that of the first bin (from
 bottom to surface) over the power value equal to the maximum power minus
 the value introduced by the user (“
\emph on
first threshold
\emph default
”).
 In order to prevent rejecting the start of the bottom in those bottoms
 with a “step”, the bottom point is considered good when subsequently, when
 advancing towards the surface, the software finds a value below the “
\emph on
second threshold
\emph default
”.
\end_layout

\begin_layout Itemize

\color black
First threshold (default 30 dB): 
\end_layout

\begin_layout Itemize

\color black
Second threshold (default 60 dB): 
\end_layout

\begin_layout Itemize

\color black
Near field approx.
 (default 1.0 m): 
\end_layout

\begin_layout Standard

\color black
As in the previous case, this method also allows to smooth out the calculated
 bottoms.
 
\end_layout

\begin_layout Itemize

\color black
Range smoothing radius (no.
 pings; default no smoothing): 15
\end_layout

\begin_layout Itemize

\color black
Smoothing sigmas (default, 3): 3 
\end_layout

\begin_layout Standard

\color black
After any of the two methods, the bathymetry is generated.
 The user has the option to perform a later section removing those depths
 below a defined threshold.
 
\end_layout

\begin_layout Itemize

\color black
Minimum depth cutoff (m, default none): 3
\end_layout

\begin_layout Subsubsection*

\color black
[3] Bathymetry toolkit / [2] One-step bathymetry computation
\end_layout

\begin_layout Standard

\color black
This step is optional.
 It represents a synthesis of the steps [1] Load transects/survey, [2] Select
 working transect and [3] Bathymetry toolkit / [1] Bottom detection.
 It loads the files selected by the user ([1]), assumes all of them are
 to be analyzed ([2]) and calculates the bottom ([3, 1]).
 
\end_layout

\begin_layout Standard

\color black
This option is conceived to speed up the bathymetric calculation for those
 users that do not have powerful computers and/or do not want to perform
 any other processing beyond bathymetry.
 Unlike what happens when following steps [1], [2] and [3, 1], in this case
 the software stores only the calculated bathymetric data (X, Y, Z) and
 not all the information contained in the echogram.
\end_layout

\begin_layout Standard

\color black
The menus in this option are the same as in options [1] and [3, 1].
\end_layout

\begin_layout Subsubsection*

\color black
[3] Bathymetry toolkit / [3] Tide correction 
\end_layout

\begin_layout Standard

\color black
In order to improve the result of the calculated bathymetries, it is necessary
 to perform tide correction in order to obtain all depth values related
 to the same tidal point, particularly when working in meso- or macrotidal
 coasts.
 
\end_layout

\begin_layout Standard
This software tool allows to correct each calculated depth value, knowing
 the tide value in the moment of data acquisition, and adjusting it to a
 reference minimum tide situation in the port where the nearest tide gauge
 is located (according to which the harmonics to predict the tide have been
 calculated).
 
\end_layout

\begin_layout Standard
In order to know the date for each ping, either the software can read it
 directly from the files (which are usually named by the echosounder with
 the date of acquisition) or the user can add it manually (when analyzing
 data corresponding to a single day).
 
\end_layout

\begin_layout Itemize
[1] Filename format (eg.
 Lxxxx-DyyyyMMdd-Ttttttt-SSSSS) 
\end_layout

\begin_layout Itemize
[2] Input DD-MM-YYYY for every transect 
\end_layout

\begin_layout Itemize
[3] Input YYYY-MM-DD for every transect 
\end_layout

\begin_layout Itemize
[4] Input [yyyy, mm, dd] for every transect 
\end_layout

\begin_layout Itemize
[5] Quit 
\end_layout

\begin_layout Standard
If the first option is selected ([1] Filename format (eg.
 Lxxxx-DyyyyMMdd-Ttttttt-SSSSS)), the program will ask for the file name
 pattern (providing the Simrad echosounder pattern by default).
 If this type of echosounder is used it is enough to accept the default
 option proposed by the software.
 
\end_layout

\begin_layout Itemize
Filename pattern (eg.
 Lxxxx-DyyyyMMdd-Ttttttt-SSSSS): 
\end_layout

\begin_layout Standard
Selecting the second, third and fourth options ([2] Input DD-MM-YYYY for
 every transect, [3] Input YYYY-MM-DD for every transect, [4] Input [yyyy,
 mm, dd] for every transect), the software will ask the user for the date
 of the loaded files: 
\end_layout

\begin_layout Itemize
Date of "L0000-D20080503-T084718-EA400" (DD-MM-YYYY): 03-05-2008
\end_layout

\begin_layout Itemize
Date of "L0000-D20080503-T084718-EA400" (YYYY-MM-DD): 2008-05-03
\end_layout

\begin_layout Itemize
Date of "L0000-D20080503-T084718-EA400" [YYYY, MM, DD]: [2008,05,03] 
\end_layout

\begin_layout Standard
The information regarding tidal dynamics in the date of acquisition must
 be added by the user, who can do it in three different ways: 
\end_layout

\begin_layout Itemize
Tide information: 
\end_layout

\begin_layout Itemize
[1] Input tide times and heights 
\end_layout

\begin_layout Itemize
[2] Input day tide height filename (hh, mm; hgt (m)) 
\end_layout

\begin_layout Itemize
[3] Automatically choose a tide height file 
\end_layout

\begin_layout Itemize
[4] Quit
\end_layout

\begin_layout Standard
With the first and second methods ([1] Input tide times and heights), the
 user must add the data regarding hours, minutes and seconds, and the tidal
 coefficient for high and low tides for each day.
 
\end_layout

\begin_layout Itemize
Time [hh, mm, ss] (empty ends): [05,46,00] 
\end_layout

\begin_layout Itemize
Tide height (m): 3.25 
\end_layout

\begin_layout Itemize
Time [hh, mm, ss] (empty ends): [11,42,00] 
\end_layout

\begin_layout Itemize
Tide height (m): 0.88 
\end_layout

\begin_layout Itemize
Time [hh, mm, ss] (empty ends): [17,57,00] 
\end_layout

\begin_layout Itemize
Tide height (m): 3.53 
\end_layout

\begin_layout Itemize
Time [hh, mm, ss] (empty ends): [24,12,0.76] 
\end_layout

\begin_layout Itemize
Tide height (m): 0.76 
\end_layout

\begin_layout Itemize
Time [hh, mm, ss] (empty ends):
\end_layout

\begin_layout Standard
The second method ([2] Input day tide height filename (hh, mm; hgt (m)))
 allows the reading of tide data from a file.
 Only one file per day can be added using this method.
\end_layout

\begin_layout Itemize
File with tide heights (hh, mm, hgt): tides20050806.txt 
\end_layout

\begin_layout Standard
The third method ([3] Automatically choose a tide height file) allows the
 user to tell the program to read a series of files, each of which has the
 tide data corresponding to a single day.
 In order to do this, the software asks for the pattern in the files, in
 order to recognize the date corresponding to each one.
 For example, if the files have names such as “tide2008_day1308.txt”, the
 pattern would be “tideyyyy_dayDDMM.txt” 
\end_layout

\begin_layout Itemize
Pattern of the date-tide filename (eg.
 tides-yyyyMMdd.txt): tideyyyy_dayDDMM.txt
\end_layout

\begin_layout Standard
The files used for options [2] and [3] must be .txt or .dat and have the following
 structure:
\end_layout

\begin_layout Standard
\noindent
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Hour 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Minute 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Height (m)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
46
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.25
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
42
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.88
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
17
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
57
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3.53
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
24
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.76
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Subsubsection*

\color black
[3] Bathymetry toolkit / 
\color inherit
[4] Bathymetry subsampling 
\end_layout

\begin_layout Standard
This option allows to correct the effects of the movement of the boat hull
 (and of the transducer, if it is bound to it), when these have not been
 previously corrected by a pitch and roll sensor, through the application
 of a minimum filter.
\end_layout

\begin_layout Standard
Following the direction defined by the sampling points (
\emph on
pings
\emph default
) in each transect, the software selects the point with the bathymetric
 value corresponding to the quantile of the lowest 10% (the one obtained
 from the most vertical insonification, discarding the absolute minimum
 in order to prevent the selection of erroneous bottom detection) among
 those contained in a given length (defined by the user).
\end_layout

\begin_layout Itemize

\color black
Search radius (m) (default 10 m): 
\end_layout

\begin_layout Standard
This process is performed for each .raw file; thus, in the file limits within
 the transects, the density of selected points may be higher.
 
\end_layout

\begin_layout Standard
The latitude and longitude of selected points will be calculated as the
 average of coordinates of all the points contained in the distance unit
 defined by the user.
 
\end_layout

\begin_layout Standard
In order to correctly perform this step, a correct bottom detection is required,
 therefore previous smoothing [3,1,”Range smoothing radius”] is recommended.
\end_layout

\begin_layout Subsubsection*

\color black
[3] Bathymetry toolkit / 
\color inherit
[5] Bathymetry resampling 
\end_layout

\begin_layout Standard
This tool performs a Monte Carlo simulation which generates, around each
 bathymetric point, ten points with a Gaussian distribution, with depth
 values depending on the slope at each point and on the angle between the
 slope and the transect direction.
\end_layout

\begin_layout Standard
The software has three options for performing this calculation: 
\end_layout

\begin_layout Itemize
[1] External GIS application
\end_layout

\begin_layout Itemize
[2] Kernel derivative method
\end_layout

\begin_layout Itemize
[3] No slope computation
\end_layout

\begin_layout Itemize
[4] Quit
\end_layout

\begin_layout Standard
For the first of options (External GIS application), the software needs
 the user to introduce a .csv file (derived from an interpolation made by
 a GIS) with at least 4 columns: ID, slope, orientation (slope direction)
 and transect direction.
 The ID in this file must be the same as in the data file imported from
 GIS, which is generated from the menu [5] Export / [2] Bathymetry data.
 
\end_layout

\begin_layout Standard
If the file has headers, the software will ask for the name of each column
 (must be introduced without quotation marks): 
\end_layout

\begin_layout Itemize
Ping ID column: 
\end_layout

\begin_layout Itemize
Slope column: 
\end_layout

\begin_layout Itemize
Slope direction colum: 
\end_layout

\begin_layout Itemize
Transect direction column:
\end_layout

\begin_layout Standard
If it does not have any name, it will ask for the column number corresponding
 to each variable.
\end_layout

\begin_layout Itemize
Ping ID column no.: 
\end_layout

\begin_layout Itemize
Slope column no.: 
\end_layout

\begin_layout Itemize
Slope direction colum no.: 
\end_layout

\begin_layout Itemize
Transect direction column no.:
\end_layout

\begin_layout Standard
Once the variables are added, the program uses the slope and orientation
 to calculate the location of each generated point, following a Gaussian
 distribution with standard deviation
\begin_inset Formula $\sigma_{xy}$
\end_inset

 and the depth value of each of them, following a Gaussian distribution
 with standard deviation 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\sigma_{z}$
\end_inset

.
 Where:
\end_layout

\begin_layout Standard
\begin_inset Formula \[
\sigma_{xy}=\delta r\times\vert\sin\triangle\theta\vert\]

\end_inset

 
\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\begin_inset Formula \[
\sigma_{z}=\delta r\times\vert\sin\triangle\theta\vert\times\vert S\vert\]

\end_inset


\end_layout

\begin_layout Standard

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
Where 
\begin_inset Formula $\delta r$
\end_inset

 is the r.m.s.
 error, derived from GPS positioning (which takes a constant value of 
\begin_inset Formula $5\mbox{ m}$
\end_inset

), 
\begin_inset Formula $\vert\sin\triangle\theta\vert$
\end_inset

 is the absolute value of the angle between the slope orientation and the
 transect direction (assumed to be optimal when perpendicular to bathymetric
 lines or, as orientation, to the coastline) and
\begin_inset Formula $\vert S\vert$
\end_inset

is the absolute slope value in each point.
\end_layout

\begin_layout Standard
The second method (Kernel derivative method) calculates the slope value
 for each point using a weighed distance interpolation and, from these,
 the angle between slope orientation and transect direction.
 From these slope values, the software applies the previous equations (
\begin_inset Formula $\sigma_{xy}\mbox{ y }\sigma_{z}$
\end_inset

).
 The software allows the user to export slope values calculated using this
 method.
 
\end_layout

\begin_layout Itemize
Export computed slopes? (y/N) 
\end_layout

\begin_layout Standard
The last method (No slope computation) ignores the effect of the slope and
 calculates the new depth points following a Gaussian distribution with
 a standard deviation equal to the GPS error.
 
\end_layout

\begin_layout Standard
These last two methods work directly with the matrix of bathymetric values,
 generated in the previous steps; they do not ask for nor admit an external
 file.
 
\end_layout

\begin_layout Subsubsection*

\color black
[3] Bathymetry toolkit / 
\color inherit
[6] Restore sonar bathymetry
\end_layout

\begin_layout Standard

\color black
This option removes all processes performed on the bathymetry and substitutes
 data for those originally calculated by the software [3, 1], including
 bottom detection and smoothing previously carried out.
 As in the previous case, the user has the option to perform a subsequent
 step removing those depths smaller than a defined threshold.
\end_layout

\begin_layout Itemize

\color black
Minimum depth cutoff (m, default none): 
\end_layout

\begin_layout Subsubsection*
[4] Plot
\end_layout

\begin_layout Standard
This menu allows the generation of three different graphic outputs of the
 original data and the generated bathymetry.
 It features 5 options:
\end_layout

\begin_layout Itemize
[1] Echogram + bottom detection
\end_layout

\begin_layout Itemize
[2] Transects
\end_layout

\begin_layout Itemize
[3] 3-D bathymetry
\end_layout

\begin_layout Itemize
[4] Bathymetry transect crosses
\end_layout

\begin_layout Itemize
[5] Interpolated bathymetry
\end_layout

\begin_layout Itemize
[6] Quit
\end_layout

\begin_layout Subsubsection*
[4] Plot / [1] Echogram + bottom detection
\end_layout

\begin_layout Standard
An image is generated, representing all the values in the selected .raw data
 (an echogram) along with the calculated bathymetry, represented by a blue
 line.
 In order to generate this image it is required to have selected a single
 .raw file from [2] Select working transect.
\end_layout

\begin_layout Standard
The software asks the user for a range of pings and bins (vertical values)
 for plotting:
\end_layout

\begin_layout Itemize
Select ping range (default entire transect): 
\end_layout

\begin_layout Itemize
Select bin range (default whole range): 
\end_layout

\begin_layout Itemize
Export figure data? (y/N)
\end_layout

\begin_layout Itemize
Output file name (default echobottom.dat): echogram1.dat
\end_layout

\begin_layout Itemize
Ping step (default 1):
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename figs_bat/plot4_1.png
	lyxscale 50
	width 80text%

\end_inset


\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Moreover, if allows to export bathymetric data represented overlapping the
 echogram (xyz).
\end_layout

\begin_layout Itemize
Export figure data? (y/N)
\end_layout

\begin_layout Standard
In order for this option to be available, only a single .raw file must be
 selected ([2])
\end_layout

\begin_layout Subsubsection*
[4] Plot / [2] Transects
\end_layout

\begin_layout Standard
An image is generated, showing the working transects in the study area.
 The software allows the representation of coordinates in UTM and decimal
 degrees.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename figs_bat/plot4_2.png
	lyxscale 50
	width 80text%

\end_inset

 
\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The software allows exporting the represented data:
\end_layout

\begin_layout Itemize
Export figure data? (y/N)
\end_layout

\begin_layout Subsubsection*
[4] Plot / [3] 3-D bathymetry
\end_layout

\begin_layout Standard
It allows for 3-D visualization of transects: with their coordinates (in
 UTM or decimal degrees) and their depth value.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename figs_bat/plot4_3.png
	lyxscale 50
	width 80text%

\end_inset


\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The software allows exporting the represented data:
\end_layout

\begin_layout Itemize
Export figure data? (y/N)
\end_layout

\begin_layout Subsubsection*
[4] Plot / [4] Bathymetry transect crosses 
\end_layout

\begin_layout Standard
It allows representing the bathymetric differences in the crossings between
 transects.
 The user can define the spatial resolution at which the transects are examined
 for crossings (in bathymetric point units).
\end_layout

\begin_layout Itemize
Point subsampling (default 5)
\end_layout

\begin_layout Standard
It only shows an image if the transects included in the bathymetry have
 any crossing.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename figs_bat/fig4_4.png
	lyxscale 50
	width 80text%

\end_inset


\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
[4] Plot / [5] Interpolated bathymetry
\end_layout

\begin_layout Standard
This section presents several options for generating images, all of them
 as a result of an interpolation process based on weighed distances.
\end_layout

\begin_layout Itemize
[1] Colored map representation
\end_layout

\begin_layout Itemize
[2] 3-D elevation map 
\end_layout

\begin_layout Itemize
[3] Contour map
\end_layout

\begin_layout Itemize
[4] Quit 
\end_layout

\begin_layout Paragraph*
[4] Plot / [5] Interpolated bathymetry / [1] Colored map representation
\end_layout

\begin_layout Standard
It represents the interpolated bathymetry from the processed bathymetry
 data (or from the original data, if no subsequent processing was applied)
 in a 2D image.
 The user can define the pixel size of the generated raster, the interpolation
 radius and the image coordinates (UTM or decimal degrees).
\end_layout

\begin_layout Itemize
Output map cell size (default, 10 m): 50 
\end_layout

\begin_layout Itemize
Interpolation radius (default, 10 m): 50 
\end_layout

\begin_layout Itemize
Use UTM coordinates? (y/N) 
\end_layout

\begin_layout Standard
The program returns the average difference between the bathymetric value
 of each point and the value of the interpolation surface corresponding
 to those points, as well as the standard deviation for that difference.
\end_layout

\begin_layout Itemize
Bathymetry mean deviation: -1.557 m 
\end_layout

\begin_layout Itemize
Bathymetry standard error: 2.9513 m 
\end_layout

\begin_layout Itemize
UTM-zone: 30 
\end_layout

\begin_layout Standard
It also allows exporting the data from the interpolated surface to a text
 file.
 
\end_layout

\begin_layout Itemize
Export figure data? (y/N)
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename figs_bat/plot4_51.png
	lyxscale 50
	width 80text%

\end_inset


\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
[4] Plot / [5] Interpolated bathymetry / [2] 3-D elevation map 
\end_layout

\begin_layout Standard
It represents the interpolated bathymetry from the processed bathymetry
 data (or from the original data, if no subsequent processing was applied)
 in a 3D image.
 The user can define the pixel size for the generated raster, the interpolation
 radius and the coordinates of the image (UTM or decimal degrees).
\end_layout

\begin_layout Itemize
Output map cell size (default, 10 m): 50 
\end_layout

\begin_layout Itemize
Interpolation radius (default, 10 m): 50 
\end_layout

\begin_layout Itemize
Use UTM coordinates? (y/N) 
\end_layout

\begin_layout Standard
The software returns the average difference between the bathymetric value
 of the points and the value of the interpolation surface corresponding
 to those points, as well as the standard deviation for that difference.
\end_layout

\begin_layout Itemize
Bathymetry mean deviation: -1.557 m 
\end_layout

\begin_layout Itemize
Bathymetry standard error: 2.9513 m 
\end_layout

\begin_layout Itemize
UTM-zone: 30 
\end_layout

\begin_layout Standard
It also allows exporting the data from the interpolated surface to a text
 file.
\end_layout

\begin_layout Itemize
Export figure data? (y/N)
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename figs_bat/plot4_52.png
	lyxscale 50
	width 80text%

\end_inset


\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
[4] Plot / [5] Interpolated bathymetry / [3] Contour map
\end_layout

\begin_layout Standard
It represents the bathymetric lines extracted from the bathymetric surface
 generated by interpolation.
\end_layout

\begin_layout Itemize
Output map cell size (default, 10 m): 50 
\end_layout

\begin_layout Itemize
Interpolation radius (default, 10 m): 50 
\end_layout

\begin_layout Itemize
Use UTM coordinates? (y/N) 
\end_layout

\begin_layout Standard
The software returns the average difference between the bathymetric value
 of the points and the value of the interpolation surface corresponding
 to those points, as well as the standard error for that difference.
\end_layout

\begin_layout Itemize
Bathymetry mean deviation: -0.25712 m 
\end_layout

\begin_layout Itemize
Bathymetry standard error: 1.6087 m 
\end_layout

\begin_layout Standard
It shows the máximum range of bathymetric values and asks for the value
 of bathymetric lines to be represented (0:5:70, from 0 m to 70 m every
 5 m).
\end_layout

\begin_layout Itemize
Interpolation depths range from 2.032 m to 70.176 
\end_layout

\begin_layout Itemize
Input depths of bathymetric lines (m): 0:5:70 
\end_layout

\begin_layout Standard
In this case it also allows exporting the data from the interpolated surface
 to a text file.
\end_layout

\begin_layout Itemize
Export figure data? (y/N)
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\noindent
\align center
\begin_inset Graphics
	filename figs_bat/plot4_53.png
	lyxscale 50
	width 80text%

\end_inset


\begin_inset Caption

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
[5] Export
\end_layout

\begin_layout Standard
This option allows the user to export files (with different data types)
 for the generation of bathymetries in a GIS or the statistical analysis
 of the data.
\end_layout

\begin_layout Itemize
[1] Echogram bottom detection 
\end_layout

\begin_layout Itemize
[2] Bathymetry data 
\end_layout

\begin_layout Itemize
[3] Bathymetry slopes 
\end_layout

\begin_layout Itemize
[4] Bathymetry transect crosses 
\end_layout

\begin_layout Itemize
[5] Interpolated bathymetry 
\end_layout

\begin_layout Itemize
[6] Current figure as image 
\end_layout

\begin_layout Itemize
[7] Quit 
\end_layout

\begin_layout Subsubsection*
[5] Export / [1] Echogram bottom detection 
\end_layout

\begin_layout Standard
It exports latitude, longitude and depth values for each ping to a text
 file (.dat), along with the transect name and the corresponding ping number,
 for the working transects.
 The bathymetric values exported are those obtained directly from the echogram
 and bottom calculation ([3, 1)].
 It allows users to define if they want to export all the bathymetric data
 or subsample them.
\end_layout

\begin_layout Itemize
Output file name (default echobottom.dat):
\end_layout

\begin_layout Itemize
Ping step (default 1):
\end_layout

\begin_layout Subsubsection*
[5] Export / [2] Bathymetry data
\end_layout

\begin_layout Standard
It exports latitude, longitude and depth values for each ping to a text
 file (.dat), along with the transect ID.
\end_layout

\begin_layout Standard
It allows users to define if they want to export all the bathymetric data
 or subsample them.
\end_layout

\begin_layout Itemize
Point subsampling (default 1):
\end_layout

\begin_layout Subsubsection*
[5] Export / [3] Bathymetry slopes 
\end_layout

\begin_layout Standard
This option allows exporting the slopes in a text file.
 The result is the same as that obtained when exporting data through option
\series bold
 
\series default
[3] Bathymetry toolkit / [5] Bathymetry resampling / Kernel derivative method
\series bold
.
\end_layout

\begin_layout Subsubsection*
[5] Export / [4] Bathymetry transect crosses 
\end_layout

\begin_layout Standard
This option allows exporting the nearest bathymetric points to crossing
 areas, with their coordinates, bathymetric value and corresponding transect.
 Moreover, for each point its depth difference regarding the nearest crossing
 point is calculated.
 
\end_layout

\begin_layout Itemize
Point subsampling (default 5)
\end_layout

\begin_layout Subsubsection*
[5] Export / [5] Interpolated bathymetry 
\end_layout

\begin_layout Standard
This option allows exporting the raster generated through bathymetry interpolati
on to Envi or ArcGIS formats.
\end_layout

\begin_layout Itemize
[1] ENVI format 
\end_layout

\begin_layout Itemize
[2] ArcMap ESRI ASC II format 
\end_layout

\begin_layout Itemize
[3] Quit
\end_layout

\begin_layout Standard
The user can define cell size and interpolation radius.
\end_layout

\begin_layout Itemize
Output map cell size (default, 10 m): 
\end_layout

\begin_layout Itemize
Interpolation radius (default, 10 m): 
\end_layout

\begin_layout Subsubsection*
[5] Export / [6] Current figure as image
\end_layout

\begin_layout Standard
This option allows saving the current figure in different image formats.
\end_layout

\begin_layout Itemize
[1] EPS: Encapsulated PostScript 
\end_layout

\begin_layout Itemize
[2] PDF: Portable Document Format 
\end_layout

\begin_layout Itemize
[3] EMF: Windows Enhanced Metafile 
\end_layout

\begin_layout Itemize
[4] FIG: FIG Format 
\end_layout

\begin_layout Itemize
[5] PNG: Portable Network Graphics 
\end_layout

\begin_layout Itemize
[6] JPEG: Joint Photograph Experts Group 
\end_layout

\begin_layout Subsubsection*
[6] Others
\end_layout

\begin_layout Standard
This menu includes every other option that doesn’t fit in the rest of the
 menus: create and restore back ups, define variables manually, etc.Este
 menú incluye todas aquellas opciones que no encajan en el resto de menús:
 crear y restaurar copias de respaldo, definir variables manualmente, etc.
\end_layout

\begin_layout Itemize
[1] Set plot char 
\end_layout

\begin_layout Itemize
[2] Set canonical sound velocity 
\end_layout

\begin_layout Itemize
[3] Plot data from file 
\end_layout

\begin_layout Itemize
[4] Save SONAR_DATA 
\end_layout

\begin_layout Itemize
[5] Restore SONAR_DATA 
\end_layout

\begin_layout Itemize
[6] Save BATHYMETRY 
\end_layout

\begin_layout Itemize
[7] Restore BATHYMETRY 
\end_layout

\begin_layout Itemize
[8] Quit 
\end_layout

\begin_layout Subsubsection*
[6] Others / [1] Set plot char 
\end_layout

\begin_layout Standard
This option allows the user to chose the plot symbol characteristics.
\end_layout

\begin_layout Standard
The symbol shape:
\end_layout

\begin_layout Itemize
[1] .
 (dots) 
\end_layout

\begin_layout Itemize
[2] ^ (impulses) 
\end_layout

\begin_layout Itemize
[3] + (symbol) 
\end_layout

\begin_layout Itemize
[4] x (symbol) 
\end_layout

\begin_layout Itemize
[5] * (symbol) 
\end_layout

\begin_layout Itemize
[6] o (symbol) 
\end_layout

\begin_layout Itemize
[7] - (line) 
\end_layout

\begin_layout Itemize
[8] +- (line-point) 
\end_layout

\begin_layout Standard
The symbol color:
\end_layout

\begin_layout Itemize
[1] black 
\end_layout

\begin_layout Itemize
[2] red 
\end_layout

\begin_layout Itemize
[3] green 
\end_layout

\begin_layout Itemize
[4] blue 
\end_layout

\begin_layout Itemize
[5] magenta 
\end_layout

\begin_layout Itemize
[6] cyan
\end_layout

\begin_layout Itemize
[7] (default)
\end_layout

\begin_layout Subsubsection*
[6] Others / [2] Set canonical sound velocity 
\end_layout

\begin_layout Standard
This option allows the user to input a specif speed, instead of reading
 it from the .raw file.
\end_layout

\begin_layout Itemize
Input canonical sound velocity (1500 m/s): 
\end_layout

\begin_layout Standard
To apply this setting, it is needed to have previously selected working
 files with [2] Select working transect.
 Once the new velocity is introduced, all bathymetric computations will
 be performed with this and not with those recorded in the .raw files.
\end_layout

\begin_layout Subsubsection*
[6] Others / [3] Plot data from file 
\end_layout

\begin_layout Standard
This option allows the user to introduce a file (x,y,z) previoulsy generated
 with this tool, or originally from other, and to represent the data in
 a graphic way .
\end_layout

\begin_layout Itemize
Input data file name: 
\end_layout

\begin_layout Standard
The file has to have a plain text format CSV or TSV, with at least two columns
 (with or without heading): latitude and longitude.
 It has to be saved in the working folder.
\end_layout

\begin_layout Standard
When the working folder is loaded (with the full name and the extension
 of the document) the program asks, firstly, what type of file it is (what
 is the field separator used) and secondly if it has a heading; in the case
 it does have a heading, the program will ask for the label of the latitude
 (x) and longitude (y) fields, and whether there is another field to be
 represented as z.
 If the file does not have a heading, it will asks which column number correspon
ds to each variable.
\end_layout

\begin_layout Itemize
Data file type: 
\end_layout

\begin_layout Itemize
[1] CSV (comma separated values) 
\end_layout

\begin_layout Itemize
[2] TSV (tab separated values) 
\end_layout

\begin_layout Itemize
[3] Quit 
\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Itemize
Column headers? (Y/n) y
\end_layout

\begin_layout Itemize
X column: lon 
\end_layout

\begin_layout Itemize
Y column: lat 
\end_layout

\begin_layout Itemize
Data is categorized? (N/y) y 
\end_layout

\begin_layout Itemize
Category column: depth
\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Itemize
Column headers? (Y/n) n
\end_layout

\begin_layout Itemize
X column no.: 1
\end_layout

\begin_layout Itemize
Y column no.: 2
\end_layout

\begin_layout Itemize
Data is categorized? (N/y) y 
\end_layout

\begin_layout Itemize
Category column: 3
\end_layout

\begin_layout Subsubsection*
[6] Others / [4] Save SONAR_DATA 
\end_layout

\begin_layout Standard
This option allows the user to save a .mat file with all the data that have
 been loaded in the application until that moment: loaded files and selection
 of the working files.
\end_layout

\begin_layout Itemize
SONAR DATA file name (default: SONAR_DATA.mat): 
\end_layout

\begin_layout Standard
The file will be saved in the working folder.
 This option is used to save the session and be able to restore is, avoiding
 the time it takes to load all data again.
\end_layout

\begin_layout Subsubsection*
[6] Others / [5] Restore SONAR_DATA 
\end_layout

\begin_layout Standard
This option allows to restore the previos work session data that was saved
 in a back up file with [6] Others / [4] Save SONAR_DATA.
 The loaded and selected files will be restored.
\end_layout

\begin_layout Itemize
SONAR DATA file name (default: SONAR_DATA.mat):
\end_layout

\begin_layout Subsubsection*
[6] Others / [6] Save BATHYMETRY 
\end_layout

\begin_layout Standard
This options allows to save a .mat file with a previously generated and processed
 batymetry (every filter that was applied, or the external data loaded).
\end_layout

\begin_layout Itemize
BATHYMETRY file name (default: BATHYMETRY.mat):
\end_layout

\begin_layout Standard
The file will be saved in the working folder.
 This option is used to save the current session and be able to restore
 it later without having to spend the time in processing the data again
 (it is advised if you want to perform any process that might be necessary
 to revert/undo later on).
 
\end_layout

\begin_layout Subsubsection*
[6] Others / [7] Restore BATHYMETRY 
\end_layout

\begin_layout Standard
This option allows to restore the batymetric data from a previous session
 that was saved in a back up file using [6] Others / [6] Save BATHYMETRY.
 The bathymetric data that were calculated in the previous sesion and the
 subsequent postprocesses will be restored.
\end_layout

\begin_layout Itemize
BATHYMETRY file name (default: BATHYMETRY.mat):
\end_layout

\begin_layout Subsubsection*
[6] Others / [8] About ecosons_bathy 
\end_layout

\begin_layout Standard
This options gives the user the information related to the 
\emph on
ecosons
\emph default
 tool.
\end_layout

\begin_layout Standard
\noindent
\align center
Ecosons is free software released under GNU-GPL license 
\end_layout

\begin_layout Standard
\noindent
\align center
(see http://www.gnu.org/copyleft/gpl.html) 
\end_layout

\begin_layout Standard
\noindent
\align center
Octave version 3.2.3 (required >=3.0.1) 
\end_layout

\begin_layout Standard
\noindent
\align center
Ecosons for Octave: 1.0 beta 
\end_layout

\begin_layout Standard
\noindent
\align center
Bathymetry toolkit: 1.0 alpha 
\end_layout

\begin_layout Standard
\noindent
\align center
http://www.recursosmarinos.net 
\end_layout

\begin_layout Section
\start_of_appendix
Appendix
\end_layout

\begin_layout Standard
Alternatively, the following lines can be added to the octave user configuration
 file, a file called .octaverc that can be found in the user's directory:
\end_layout

\begin_layout Standard
global ECOSONS_BATHY_HOME
\end_layout

\begin_layout Standard
ECOSONS_BATHY_HOME='c:/ecosons_bathy';
\end_layout

\begin_layout Standard
addpath(ECOSONS_BATHY_HOME);
\end_layout

\begin_layout Standard
addpath([ECOSONS_BATHY_HOME, '/procs']);
\end_layout

\begin_layout Standard
addpath([ECOSONS_BATHY_HOME, '/utils']);
\end_layout

\begin_layout Standard
addpath([ECOSONS_BATHY_HOME, '/formats']);
\end_layout

\begin_layout Standard
It is supposed that the ecosons distribution has been unzipped to a directory/fo
lder called c:/ecosons_bathy, and that it is in that folder where the file
 ec.m can be found.
 When performing this installation, the ecosons will run from any directory
 octave can be run.
\end_layout

\end_body
\end_document
